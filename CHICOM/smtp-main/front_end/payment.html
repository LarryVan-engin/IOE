<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Thanh toán</title>
<style>
/* ================= CSS VARIABLES ================= */
:root {
    --color-primary-dark: #2b3a55;
    --color-error: #dc3545; 
    --color-text-light: white;
}

/* ------------------------------ */
/* TOÀN TRANG (RESET & CƠ BẢN) */
/* ------------------------------ */
* { box-sizing: border-box; margin: 0; padding: 0; }
body { 
    font-family: "Segoe UI", sans-serif; 
    background:#f0f2f5; 
    /* Giữ lại căn giữa màn hình */
    display:flex; 
    flex-direction: column; /* Cho phép xếp chồng nav và container */
    justify-content:center; 
    align-items:center; 
    min-height:100vh; 
}

/* ------------------------------ */
/* NAVIGATION BAR (CẢI TIẾN) */
/* ------------------------------ */
.floating-nav {
    position: fixed; /* Neo vào góc trên */
    top: 20px;
    right: 20px;
    display: flex;
    gap: 10px;
}
.nav-btn {
    padding: 10px 18px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1em;
    font-weight: 600;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.12);
    transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
}
.back-btn {
    background: #6c757d;
    color: white;
}
.back-btn:hover {
    background: #5a6268;
    box-shadow: 0 6px 12px rgba(90,98,104,0.4);
    transform: translateY(-2px);
}
.logout-btn {
    background: var(--color-error);
    color: var(--color-text-light);
}
.logout-btn:hover {
    background: #b02a37;
    box-shadow: 0 6px 16px rgba(176,42,55,0.6);
    transform: translateY(-2px);
}

/* ------------------------------ */
/* PAYMENT CONTAINER (Giữ nguyên) */
/* ------------------------------ */
.payment-container { 
    background:white; 
    padding:30px; 
    border-radius:12px; 
    box-shadow:0 4px 15px rgba(0,0,0,0.1);
    width: 100%;
    max-width:350px;
    text-align:center; 
}
h2 { margin-bottom:20px; color:var(--color-primary-dark); }
p { color: #6c757d; margin-bottom: 5px; }
button { 
    padding:12px 20px; 
    border:none; 
    border-radius:6px; 
    background:var(--color-primary-dark); 
    color:white; 
    font-size:16px; 
    cursor:pointer; 
    margin-top:20px;
    transition:background 0.2s; 
    width: 100%;
}
button:hover { 
    background:#1f2b44; 
}
.qr { 
    margin: 20px auto 10px auto; 
    padding: 10px;
}
.qr img { 
    width:200px; 
    height:200px;
    border: 1px solid #ddd;
    border-radius: 4px;
}
</style>
</head>
<body>

<div class="floating-nav">
    <a href="user_dashboard.html" class="nav-btn back-btn">← Trở về</a>
    <button class="nav-btn logout-btn" type="button" onclick="logout()">Đăng Xuất</button>
</div>

<div class="payment-container">
    <h2>Thanh toán đơn hàng #2053</h2>
    
    <div class="qr">
        <p>Vui lòng quét mã QR để chuyển khoản:</p>
        <img src="path/to/your/qr_code.png" alt="Mã QR thanh toán" /> 
    </div>
    
    <button onclick="confirmPayment()">Xác nhận thanh toán</button>
</div>

<script>
    function getQuery(name){
        const params = new URLSearchParams(location.search);
        return params.get(name);
        }
    async function confirmPayment(){
        const orderId = getQuery('orderId');
        if(!orderId){ alert("Order ID missing"); return; }
        const res = await fetch(`http://localhost:8000/v1/orders/${orderId}/confirm-payment`, {
            method: "POST",
            headers: { "Content-Type": "application/json", "Authorization": "Bearer " + localStorage.getItem("accessToken") },
            credentials: "include"
        });
        const data = await res.json();
        if(res.ok){
            alert("Bạn đã xác nhận thanh toán. Đơn hàng đang chờ admin xác nhận.");
            window.location.href = "user_dashboard.html";
        } else {
            alert(data.message || "Lỗi xác nhận");
        }
    }

// Hàm Đăng xuất (Đã thêm)
    function logout() {
        const confirmLogout = confirm("Bạn có muốn đăng xuất khỏi hệ thống không?");
        if (confirmLogout) {
            localStorage.removeItem('accessToken'); 
            window.location.href = "smtp-main\front_end\login.html"; 
        }
    }

// Giả sử tên người dùng được lưu trong localStorage (chỉ để giữ code chuẩn)
    window.onload = function() {
        const userName = localStorage.getItem('username') || 'Khách hàng'; 
        console.log(`Xin chào, ${userName}! Trang thanh toán đã tải.`);
    };

</script>
<script src="js/auth.js"></script>

</body>
</html>
